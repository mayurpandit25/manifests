apiVersion: apps/v1
kind: Deployment
metadata: 
  name: tomcat
spec: 
  replicas: 2
  selector: 
    matchLabels: 
      app: tomcat
  template: 
    metadata: 
      labels:  
        app: tomcat
    spec: 
      containers:
      - name: tomcat
        image: mayurpandit25/student:multi-stage
        ports:
        - containerPort: 8080
     
        readinessProbe: 
          httpGet: 
            path: /student
            port: 8080
          initialDelaySeconds: 15
          periodSeconds: 10
 
        livenessProbe: 
          httpGet: 
            path: /student
            port: 8080
          initialDelaySeconds: 15
          periodSeconds: 10

        startupProbe: 
          httpGet: 
            path: /student
            port: 8080
          initialDelaySeconds: 15
          periodSeconds: 10
  
        env: 
        - name: Port
          value: "8080"
---
apiVersion: v1
kind: Service
metadata: 
  name: tomcat-svc
  labels: 
    app: tomcat
spec: 
  type: NodePort
  selector: 
    app: tomcat
  ports: 
  - name: myport
    protocol: TCP 
    port: 8080
    targetPort: 8080
